(function() {  
  
  var app = angular.module('earfulOfAngular',[]);

  app.controller('FeedController', function($scope, $http) {
    $scope.feedItems = [];
    $scope.editItem = false;
    $scope.userId = $('#user_id').attr("value");
    $http.get('/users/'+ $scope.userId +'/posts.json').success(function(data){
      $scope.feedItems = data
      console.log($scope.feedItems);
    });

    $scope.selectEditItem = function(item){
      $scope.editItem = item;
    }

    $scope.selectUpdateItem = function(item){
      $http.put('/users/'+ $scope.userId + '/posts/' + item.id + '.json', item ).success(function(data){
        $scope.editItem = 0;
        var index = $scope.feedItems.indexOf(item);
        console.log('Index equals: ' + index);
        $scope.feedItems.splice(index, 1, data);
        
        console.log(data);
      });
    }

    $scope.togglePost = function(item){
          $("#content" + item.id).slideToggle(500, function(){});
    }

    // functions for the Feed page
    $scope.loadFeed = function(){
      $('#myfeed').addClass('hide');
      $('#feedList').removeClass('hide');
    }
    $scope.loadMyFeed = function(){
      $('#myfeed').removeClass('hide');
      $('#feedList').addClass('hide');
    }


  });

})();